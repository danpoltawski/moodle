YUI.add("moodle-filter_glossary-autolinker",function(a,b){var c,d="Glossary filter autolinker",e="width",f="height",g="menubar",h="location",i="scrollbars",j="resizable",k="toolbar",l="status",m="directories",n="fullscreen",o="dependent";c=function(){c.superclass.constructor.apply(this,arguments)},a.extend(c,a.Base,{overlay:null,alertpanels:{},initializer:function(){var b=this;require(["core/event"],function(c){a.delegate("click",function(d){d.preventDefault();var e,f,g="",h=a.Node.create('<div id="glossaryfilteroverlayprogress"><img src="'+M.cfg.loadingicon+'" class="spinner" /></div>'),i=new a.Overlay({headerContent:g,bodyContent:h});b.overlay=i,i.render(a.one(document.body)),e=this.getAttribute("href").replace("showentry.php","showentry_ajax.php"),f={method:"get",context:b,on:{success:function(a,b){this.display_callback(b.responseText,c)},failure:function(a,b){var c=b.statusText;M.cfg.developerdebug&&(b.statusText+=" ("+e+")"),new M.core.exception({message:c})}}},a.io(e,f)},a.one(document.body),"a.glossary.autolink.concept")})},display_callback:function(b,c){var d,e,f,g,h,i;try{if(d=a.JSON.parse(b),d.success){this.overlay.hide();for(e in d.entries)h=d.entries[e].definition+d.entries[e].attachments,f=new M.core.alert({title:d.entries[e].concept,draggable:!0,message:h,modal:!1,yesLabel:M.util.get_string("ok","moodle")}),c.notifyFilterContentUpdated(f.get("boundingBox").getDOMNode()),a.Node.one("#id_yuialertconfirm-"+f.get("COUNT")).focus(),g="#moodle-dialogue-"+f.get("COUNT"),f.on("complete",this._deletealertpanel,this,g),a.Object.isEmpty(this.alertpanels)||(i=this._getLatestWindowPosition(),a.Node.one(g).setXY([i[0]+10,i[1]+10])),this.alertpanels[g]=a.Node.one(g).getXY();return!0}d.error&&new M.core.ajaxException(d)}catch(j){new M.core.exception(j)}return!1},_getLatestWindowPosition:function(){var b=[0,0];return a.Object.each(this.alertpanels,function(a){a[0]>b[0]&&(b=a)}),b},_deletealertpanel:function(a,b){delete this.alertpanels[b]}},{NAME:d,ATTRS:{url:{validator:a.Lang.isString,value:M.cfg.wwwroot+"/mod/glossary/showentry.php"},name:{validator:a.Lang.isString,value:"glossaryconcept"},options:{getter:function(){return{width:this.get(e),height:this.get(f),menubar:this.get(g),location:this.get(h),scrollbars:this.get(i),resizable:this.get(j),toolbar:this.get(k),status:this.get(l),directories:this.get(m),fullscreen:this.get(n),dependent:this.get(o)}},readOnly:!0},width:{value:600},height:{value:450},menubar:{value:!1},location:{value:!1},scrollbars:{value:!0},resizable:{value:!0},toolbar:{value:!0},status:{value:!0},directories:{value:!1},fullscreen:{value:!1},dependent:{value:!0}}}),M.filter_glossary=M.filter_glossary||{},M.filter_glossary.init_filter_autolinking=function(a){return new c(a)}},"@VERSION@",{requires:["base","node","io-base","json-parse","event-delegate","overlay","moodle-core-event","moodle-core-notification-alert","moodle-core-notification-exception","moodle-core-notification-ajaxexception"]});