YUI.add("moodle-availability_date-form",function(a,b){M.availability_date=M.availability_date||{},M.availability_date.form=a.Object(M.core_availability.plugin),M.availability_date.form.initInner=function(a,b){this.html=a,this.defaultTime=b},M.availability_date.form.getNode=function(b){var c='<span class="col-form-label p-r-1">'+M.util.get_string("direction_before","availability_date")+'</span> <span class="availability-group"><label><span class="accesshide">'+M.util.get_string("direction_label","availability_date")+' </span><select name="direction" class="custom-select"><option value="&gt;=">'+M.util.get_string("direction_from","availability_date")+'</option><option value="&lt;">'+M.util.get_string("direction_until","availability_date")+"</option></select></label></span> "+this.html,d=a.Node.create("<span>"+c+"</span>");if(void 0!==b.t){d.setData("time",b.t),d.all("select:not([name=direction])").each(function(a){a.set("disabled",!0)});var e=M.cfg.wwwroot+"/availability/condition/date/ajax.php?action=fromtime&time="+b.t;a.io(e,{on:{success:function(b,c){var e=a.JSON.parse(c.responseText);for(var f in e){var g=d.one("select[name=x\\["+f+"\\]]");g.set("value",""+e[f]),g.set("disabled",!1)}},failure:function(){window.alert(M.util.get_string("ajaxerror","availability_date"))}}})}else d.setData("time",this.defaultTime);if(void 0!==b.d&&d.one("select[name=direction]").set("value",b.d),!M.availability_date.form.addedEvents){M.availability_date.form.addedEvents=!0;var f=a.one(".availability-field");f.delegate("change",function(){M.core_availability.form.update()},".availability_date select[name=direction]"),f.delegate("change",function(){M.availability_date.form.updateTime(this.ancestor("span.availability_date"))},".availability_date select:not([name=direction])")}if(d.one("a[href=#]")){M.form.dateselector.init_single_date_selector(d);var g=d.one("select[name=x\\[year\\]]"),h=g.set;g.set=function(a,b){h.call(g,a,b),"selectedIndex"===a&&setTimeout(function(){M.availability_date.form.updateTime(d)},0)}}return d},M.availability_date.form.updateTime=function(b){var c=M.cfg.wwwroot+"/availability/condition/date/ajax.php?action=totime&year="+b.one("select[name=x\\[year\\]]").get("value")+"&month="+b.one("select[name=x\\[month\\]]").get("value")+"&day="+b.one("select[name=x\\[day\\]]").get("value")+"&hour="+b.one("select[name=x\\[hour\\]]").get("value")+"&minute="+b.one("select[name=x\\[minute\\]]").get("value");a.io(c,{on:{success:function(a,c){b.setData("time",c.responseText),M.core_availability.form.update()},failure:function(){window.alert(M.util.get_string("ajaxerror","availability_date"))}}})},M.availability_date.form.fillValue=function(a,b){a.d=b.one("select[name=direction]").get("value"),a.t=parseInt(b.getData("time"),10)}},"@VERSION@",{requires:["base","node","event","io","moodle-core_availability-form"]});