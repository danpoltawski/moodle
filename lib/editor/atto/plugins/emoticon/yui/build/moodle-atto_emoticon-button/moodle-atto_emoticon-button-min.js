YUI.add("moodle-atto_emoticon-button",function(a,b){var c="atto_emoticon",d={EMOTE:"atto_emoticon_emote",MAP:"atto_emoticon_map"},e={EMOTE:".atto_emoticon_emote"},f='<div class="{{CSS.MAP}}"><ul>{{#each emoticons}}<li><div><a href="#" class="{{../CSS.EMOTE}}" data-text="{{text}}"><img src="{{image_url imagename imagecomponent}}" alt="{{get_string altidentifier altcomponent}}"/></a></div><div>{{text}}</div><div>{{get_string altidentifier altcomponent}}</div></li>{{/each}}</ul></div>';a.namespace("M.atto_emoticon").Button=a.Base.create("button",a.M.editor_atto.EditorPlugin,[],{_currentSelection:null,initializer:function(){this.addButton({icon:"e/emoticons",callback:this._displayDialogue})},_displayDialogue:function(){if(this._currentSelection=this.get("host").getSelection(),this._currentSelection!==!1){var a=this.getDialogue({headerContent:M.util.get_string("insertemoticon",c),focusAfterHide:!0},!0);a.set("bodyContent",this._getDialogueContent()).show()}},_insertEmote:function(a){var b=a.target.ancestor(e.EMOTE,!0),c=this.get("host");a.preventDefault(),this.getDialogue({focusAfterHide:null}).hide();var d=" "+b.getData("text")+" ";c.setSelection(this._currentSelection),c.insertContentAtFocusPoint(d),this.markUpdated()},_getDialogueContent:function(){var b=a.Handlebars.compile(f),c=a.Node.create(b({emoticons:this.get("emoticons"),CSS:d}));return c.delegate("click",this._insertEmote,e.EMOTE,this),c.delegate("key",this._insertEmote,"32",e.EMOTE,this),c}},{ATTRS:{emoticons:{value:{}}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});