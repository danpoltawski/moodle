YUI.add("moodle-atto_accessibilityhelper-button",function(a,b){var c="atto_accessibilityhelper",d='<div><p id="{{elementid}}_{{CSS.STYLESLABEL}}">{{get_string "liststyles" component}}<br/><span aria-labelledby="{{elementid}}_{{CSS.STYLESLABEL}}" /></p></div><span class="listStyles"></span><p id="{{elementid}}_{{CSS.LINKSLABEL}}">{{get_string "listlinks" component}}<br/><span aria-labelledby="{{elementid}}_{{CSS.LINKSLABEL}}"/></p><span class="listLinks"></span><p id="{{elementid}}_{{CSS.IMAGESLABEL}}">{{get_string "listimages" component}}<br/><span aria-labelledby="{{elementid}}_{{CSS.IMAGESLABEL}}"/></p><span class="listImages"></span>',e={STYLESLABEL:c+"_styleslabel",LINKSLABEL:c+"_linkslabel",IMAGESLABEL:c+"_imageslabel"};a.namespace("M.atto_accessibilityhelper").Button=a.Base.create("button",a.M.editor_atto.EditorPlugin,[],{initializer:function(){this.addButton({icon:"e/screenreader_helper",callback:this._displayDialogue})},_displayDialogue:function(){var a=this.getDialogue({headerContent:M.util.get_string("pluginname",c),width:"800px",focusAfterHide:!0});a.set("bodyContent",this._getDialogueContent()).show()},_getDialogueContent:function(){var b=a.Handlebars.compile(d),f=a.Node.create(b({CSS:e,component:c}));return f.one(".listStyles").empty().appendChild(this._listStyles()),f.one(".listLinks").empty().appendChild(this._listLinks()),f.one(".listImages").empty().appendChild(this._listImages()),f},_listStyles:function(){var b,d=[],e=this.get("host"),f=e.getSelectionParentNode();for(f&&(f=a.one(f));f&&f!==this.editor;)b=f.get("tagName"),"undefined"!=typeof b&&d.push(a.Escape.html(b)),f=f.ancestor();return 0===d.length&&d.push(M.util.get_string("nostyles",c)),d.reverse(),d.join(", ")},_listLinks:function(){var b,d,e=a.Node.create("<ol />");return this.editor.all("a").each(function(f){d=a.Node.create('<a href="#" title="'+M.util.get_string("selectlink",c)+'">'+a.Escape.html(f.get("text"))+"</a>"),d.setData("sourcelink",f),d.on("click",this._linkSelected,this),b=a.Node.create("<li></li>"),b.appendChild(d),e.appendChild(b)},this),e.hasChildNodes()||e.append("<li>"+M.util.get_string("nolinks",c)+"</li>"),e},_listImages:function(){var b,d,e=a.Node.create("<ol/>");return this.editor.all("img").each(function(f){var g=f.getAttribute("alt");""===g&&(g=f.getAttribute("title"),""===g&&(g=f.getAttribute("src"))),d=a.Node.create('<a href="#" title="'+M.util.get_string("selectimage",c)+'">'+a.Escape.html(g)+"</a>"),d.setData("sourceimage",f),d.on("click",this._imageSelected,this),b=a.Node.create("<li></li>"),b.append(d),e.append(b)},this),e.hasChildNodes()||e.append("<li>"+M.util.get_string("noimages",c)+"</li>"),e},_imageSelected:function(a){a.preventDefault(),this.getDialogue({focusAfterNode:null}).hide();var b=this.get("host"),c=a.target.getData("sourceimage");this.editor.focus(),b.setSelection(b.getSelectionFromNode(c))},_linkSelected:function(a){a.preventDefault(),this.getDialogue({focusAfterNode:null}).hide();var b=this.get("host"),c=a.target.getData("sourcelink");this.editor.focus(),b.setSelection(b.getSelectionFromNode(c))}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});