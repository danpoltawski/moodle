YUI.add("moodle-atto_managefiles-usedfiles",function(a,b){var c={HASMISSINGFILES:"has-missing-files",HASUNUSEDFILES:"has-unused-files"},d={FILEANCESTOR:".fitem_fcheckbox",FORM:"#atto_managefiles_manageform",MISSINGFILES:".missing-files"};M.atto_managefiles=M.atto_managefiles||{},M.atto_managefiles.usedfiles=M.atto_managefiles.usedfiles||{_usercontext:null,_itemid:null,_elementid:null,init:function(b){this._usercontext=b.usercontext,this._itemid=b.itemid,this._elementid=b.elementid;var e,f,g,h,i,j=b.files,k=a.one(d.FORM);if(k&&window.parent)if(e=this._getUsedFiles(),f=this.findUnusedFiles(j,e),g=this.findMissingFiles(j,e),f.length>0?(k.all('input[type=checkbox][name^="deletefile"]').each(function(b){a.Array.indexOf(f,b.getData("filename"))===-1&&b.ancestor(d.FILEANCESTOR).remove()}),k.addClass(c.HASUNUSEDFILES)):k.removeClass(c.HASUNUSEDFILES),g.length>0){for(h="<ul>",i=0;i<g.length;i++)h+="<li>"+a.Escape.html(g[i])+"</li>";h+="</ul>",k.one(d.MISSINGFILES).setHTML("").append(h),k.addClass(c.HASMISSINGFILES)}else k.removeClass(c.HASMISSINGFILES)},_getUsedFiles:function(){for(var b=a.one(window.parent.document.getElementById(this._elementid+"editable")),c=M.cfg.wwwroot+"/draftfile.php/"+this._usercontext+"/user/draft/"+this._itemid+"/",d=new RegExp(c.replace(/[\-\/\\\^$*+?.()|\[\]{}]/g,"\\$&")+"(.+?)[\\?\"']","gm"),e="",f="",g={};null!==(f=d.exec(b.get("innerHTML")));)e=decodeURI(f[1]),g[e]=!0;return g},findUnusedFiles:function(a,b){var c,d=[];for(c in a)b[c]||d.push(c);return d},findMissingFiles:function(a,b){var c,d=[];for(c in b)a[c]||d.push(c);return d}}},"@VERSION@",{requires:["node","escape"]});