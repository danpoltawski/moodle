YUI.add("moodle-atto_media-button",function(a,b){var c="atto_media",d={URLINPUT:"atto_media_urlentry",NAMEINPUT:"atto_media_nameentry"},e={URLINPUT:"."+d.URLINPUT,NAMEINPUT:"."+d.NAMEINPUT},f='<form class="atto_form"><label for="{{elementid}}_atto_media_urlentry">{{get_string "enterurl" component}}</label><input class="fullwidth {{CSS.URLINPUT}}" type="url" id="{{elementid}}_atto_media_urlentry" size="32"/><br/><button class="openmediabrowser" type="button">{{get_string "browserepositories" component}}</button><label for="{{elementid}}_atto_media_nameentry">{{get_string "entername" component}}</label><input class="fullwidth {{CSS.NAMEINPUT}}" type="text" id="{{elementid}}_atto_media_nameentry"size="32" required="true"/><div class="mdl-align"><br/><button class="submit" type="submit">{{get_string "createmedia" component}}</button></div></form>';a.namespace("M.atto_media").Button=a.Base.create("button",a.M.editor_atto.EditorPlugin,[],{_currentSelection:null,_content:null,initializer:function(){this.get("host").canShowFilepicker("media")&&this.addButton({icon:"e/insert_edit_video",callback:this._displayDialogue})},_displayDialogue:function(){if(this._currentSelection=this.get("host").getSelection(),this._currentSelection!==!1){var a=this.getDialogue({headerContent:M.util.get_string("createmedia",c),focusAfterHide:!0,focusOnShowSelector:e.URLINPUT});a.set("bodyContent",this._getDialogueContent()).show()}},_getDialogueContent:function(){var b=a.Handlebars.compile(f);return this._content=a.Node.create(b({component:c,elementid:this.get("host").get("elementid"),CSS:d})),this._content.one(".submit").on("click",this._setMedia,this),this._content.one(".openmediabrowser").on("click",function(a){a.preventDefault(),this.get("host").showFilepicker("media",this._filepickerCallback,this)},this),this._content},_filepickerCallback:function(a){""!==a.url&&(this._content.one(e.URLINPUT).set("value",a.url),this._content.one(e.NAMEINPUT).set("value",a.file))},_setMedia:function(b){b.preventDefault(),this.getDialogue({focusAfterHide:null}).hide();var c=b.currentTarget.ancestor(".atto_form"),d=c.one(e.URLINPUT).get("value"),f=c.one(e.NAMEINPUT).get("value"),g=this.get("host");if(""!==d&&""!==f){g.setSelection(this._currentSelection);var h='<a href="'+a.Escape.html(d)+'">'+f+"</a>";g.insertContentAtFocusPoint(h),this.markUpdated()}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});