YUI.add("moodle-report_eventlist-eventfilter",function(a,b){function c(){c.superclass.constructor.apply(this,arguments)}var d={EVENTNAME:"#id_eventname",EVENTCOMPONENT:"#id_eventcomponent",EVENTEDULEVEL:"#id_eventedulevel",EVENTCRUD:"#id_eventcrud",FILTERBUTTON:"#id_filterbutton",CLEARBUTTON:"#id_clearbutton"};a.extend(c,a.Base,{_table:null,_eventName:null,_component:null,_eduLevel:null,_crud:null,initializer:function(){var b=a.one(d.FILTERBUTTON),c=a.one(d.CLEARBUTTON);this._createTable(this.get("tabledata")),this._eventName=a.one(d.EVENTNAME),this._component=a.one(d.EVENTCOMPONENT),this._eduLevel=a.one(d.EVENTEDULEVEL),this._crud=a.one(d.EVENTCRUD),this._eventName.on("valuechange",this._totalFilter,this),b.on("click",this._totalFilter,this),c.on("click",this._clearFilter,this)},_createTable:function(b){var c=new a.DataTable({columns:[{key:"fulleventname",label:M.util.get_string("eventname","report_eventlist"),allowHTML:!0,sortable:!0,sortFn:function(a,b,c){var d=a.getAttrs().raweventname,e=b.getAttrs().raweventname,f=d>e?1:-1;return c?-f:f},title:M.util.get_string("eventname","report_eventlist")},{key:"component",label:M.util.get_string("component","report_eventlist"),allowHTML:!0,sortable:!0,title:M.util.get_string("component","report_eventlist")},{key:"edulevel",label:M.util.get_string("edulevel","report_eventlist"),sortable:!0,title:M.util.get_string("edulevel","report_eventlist")},{key:"crud",label:M.util.get_string("crud","report_eventlist"),sortable:!0,title:M.util.get_string("crud","report_eventlist")},{key:"objecttable",label:M.util.get_string("affectedtable","report_eventlist"),sortable:!0,title:M.util.get_string("affectedtable","report_eventlist")},{key:"since",label:M.util.get_string("since","report_eventlist"),sortable:!0,title:M.util.get_string("since","report_eventlist")},{key:"legacyevent",label:M.util.get_string("legacyevent","report_eventlist"),sortable:!0,title:M.util.get_string("legacyevent","report_eventlist")}],data:b,strings:{sortBy:"{title}",reverseSortBy:"{title}"}});return c.render("#report-eventlist-table"),c.get("boundingBox").addClass("report-eventlist-datatable-table"),this._table=c,this},_totalFilter:function(){var b,c=this._eventName.get("value").toLowerCase(),d=this._component.get("options").item(this._component.get("selectedIndex")).get("text").toLowerCase(),e=this._component.get("value"),f=this._eduLevel.get("options").item(this._eduLevel.get("selectedIndex")).get("text").toLowerCase(),g=this._eduLevel.get("value"),h=this._crud.get("options").item(this._crud.get("selectedIndex")).get("text").toLowerCase(),i=this._crud.get("value"),j=[];for(b=0;b<this.get("tabledata").length;b++){var k=a.Node.create(this.get("tabledata")[b].fulleventname).get("text"),l=k.toLowerCase().indexOf(c)>=0,m=this.get("tabledata")[b].component.toLowerCase().indexOf(d)>=0,n=this.get("tabledata")[b].edulevel.toLowerCase().indexOf(f)>=0,o=this.get("tabledata")[b].crud.toLowerCase().indexOf(h)>=0;""===c&&(l=!0),"0"===e&&(m=!0),"0"===g&&(n=!0),"0"===i&&(o=!0),l&&m&&n&&o&&j.push(this.get("tabledata")[b])}this._table.set("data",j)},_clearFilter:function(){this._eventName.set("value",""),this._component.set("value","0"),this._eduLevel.set("value","0"),this._crud.set("value","0"),this._table.set("data",this.get("tabledata"))}},{NAME:"eventFilter",ATTRS:{tabledata:{value:null}}}),a.namespace("M.report_eventlist.EventFilter").init=function(a){return new c(a)}},"@VERSION@",{requires:["base","event","node","node-event-delegate","datatable","autocomplete","autocomplete-filters"]});